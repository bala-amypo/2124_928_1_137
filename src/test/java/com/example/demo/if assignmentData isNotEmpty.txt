if ($assignmentData->isNotEmpty()) {

    
    $upcomingAssignment = $assignmentData
        ->filter(function ($row) use ($now) {
            if (empty($row->topic_start_date)) {
                return false;
            }

            $start = \Carbon\Carbon::parse($row->topic_start_date, 'Asia/Kolkata');
            return $start->gte($now);
        })
        ->sortBy(function ($row) {
            // nearest upcoming first
            return \Carbon\Carbon::parse($row->topic_start_date, 'Asia/Kolkata');
        })
        ->first();

    if ($upcomingAssignment) {

        $start = \Carbon\Carbon::parse($upcomingAssignment->topic_start_date, 'Asia/Kolkata');
        $end   = !empty($upcomingAssignment->topic_end_date)
            ? \Carbon\Carbon::parse($upcomingAssignment->topic_end_date, 'Asia/Kolkata')
            : null;

        //  topicname
        $upcomingTopicName = $upcomingAssignment->topic_name;

        //  est time (topic start , end date)
        $upcomingEstTime = [
            'start' => $start->format('Y-m-d H:i'),
            'end'   => $end ? $end->format('Y-m-d H:i') : null,
        ];

        //  due (how many time to start)
        // here: how many days (and hours) from now to start
        $dueInMinutes = $now->diffInMinutes($start);
        $dueDays      = intdiv($dueInMinutes, 60 * 24);
        $dueHours     = intdiv($dueInMinutes % (60 * 24), 60);

        $upcomingDue = [
            'days'  => $dueDays,
            'hours' => $dueHours,
            'label' => $now->diffForHumans($start), // ex: "in 3 days"
        ];
    }
}
